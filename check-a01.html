<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IPTV M3U Reader ‚Äî StreamCraft</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" rel="stylesheet">

  <!-- ECharts, Mermaid, hls.js -->
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.0/dist/hls.min.js"></script>

  <style>
    :root{--bg:#071226;--card:#0b1630;--muted:#9aa4b2;--accent1:#60a5fa;--accent2:#2dd4bf}
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#031022);color:#e6eef6}
    .wrap{display:grid;grid-template-columns:280px 1fr;gap:20px;padding:22px;min-height:100vh}
    .sidebar{background:linear-gradient(180deg,var(--card),#071224);border-radius:12px;padding:16px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    .logo{display:flex;align-items:center;gap:12px}
    .logo .badge{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent2),var(--accent1));display:flex;align-items:center;justify-content:center;color:#012;font-weight:800}
    .logo h1{margin:0;font-size:16px}
    nav{margin-top:14px;display:flex;flex-direction:column;gap:8px}
    nav a{display:flex;gap:10px;align-items:center;padding:10px;border-radius:10px;color:var(--muted);text-decoration:none;font-weight:600}
    nav a:hover{background:rgba(255,255,255,0.02);color:#fff}
    .hint{margin-top:12px;color:var(--muted);font-size:13px}

    main{display:flex;flex-direction:column;gap:14px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:12px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.4)}
    .controls{display:flex;gap:8px;align-items:center}
    input[type=url], input[type=text]{background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);padding:10px;border-radius:10px;color:inherit;width:100%}
    .btn{background:linear-gradient(90deg,var(--accent2),var(--accent1));color:#012;padding:8px 12px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
    .two{display:grid;grid-template-columns:1fr 420px;gap:14px}
    .channels{max-height:56vh;overflow:auto;padding:6px;display:flex;flex-direction:column;gap:8px}
    .ch{display:flex;gap:10px;align-items:center;padding:8px;border-radius:10px;background:rgba(255,255,255,0.01)}
    .thumb{width:64px;height:40px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:linear-gradient(90deg,#1f2937,#111827);font-weight:700}
    .meta h4{margin:0;font-size:14px}
    .meta p{margin:4px 0 0 0;font-size:12px;color:var(--muted)}
    .play-actions{margin-left:auto;display:flex;gap:8px;align-items:center}
    #videoPlayer{width:100%;height:240px;background:#000;border-radius:8px}
    .charts{display:flex;gap:12px;margin-top:8px}
    #chartGroups,#chartProto{height:160px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent)}
    .mermaid-card{padding:8px}
    .tools{display:flex;gap:8px;margin-top:8px}

    footer{color:var(--muted);font-size:13px;padding:8px;text-align:center}

    @media (max-width:980px){
      .wrap{grid-template-columns:1fr;padding:12px}
      .two{grid-template-columns:1fr}
      #videoPlayer{height:200px}
    }
  </style>
</head>
<body>
  <div class="wrap" role="application" aria-label="M3U IPTV Utility">
    <aside class="sidebar">
      <div class="logo">
        <div class="badge">IPTV</div>
        <div>
          <h1>StreamCraft</h1>
          <div style="font-size:12px;color:var(--muted)">M3U Parser ‚Ä¢ Player ‚Ä¢ Analytics</div>
        </div>
      </div>

      <nav aria-label="Main">
        <a href="#"><span class="mdi mdi-play-circle-outline"></span> ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏á (M3U)</a>
        <a href="#"><span class="mdi mdi-file-tree"></span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≠‡∏á</a>
        <a href="#"><span class="mdi mdi-chart-donut"></span> ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</a>
        <a href="#"><span class="mdi mdi-cog-outline"></span> ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a>
      </nav>

      <div class="hint">Tip: ‡∏ñ‡πâ‡∏≤ fetch ‡∏•‡∏¥‡πâ‡∏á‡∏Ñ‡πå‡∏ï‡∏¥‡∏î CORS ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô CORS proxy ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
    </aside>

    <main>
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <strong style="font-size:16px">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ M3U / m3u8 üîó</strong>
            <div style="font-size:13px;color:var(--muted)">‡∏õ‡πâ‡∏≠‡∏ô URL ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå .m3u/.m3u8</div>
          </div>
          <div style="font-size:13px;color:var(--muted)">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö HLS ¬∑ RTMP ¬∑ HTTP</div>
        </div>

        <div style="margin-top:12px" class="controls">
          <input id="m3uUrl" type="url" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå M3U ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡πÄ‡∏ä‡πà‡∏ô https://...)">
          <button class="btn" id="fetchBtn">Fetch</button>
          <button class="btn ghost" id="useProxyBtn" title="‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏≤‡∏á CORS">‡πÉ‡∏ä‡πâ CORS proxy</button>
          <input id="fileInput" type="file" accept=".m3u,.m3u8,text/plain" style="display:none">
          <button class="btn ghost" id="uploadBtn"><span class="mdi mdi-upload"></span> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</button>
        </div>

        <div class="tools">
          <button class="btn" id="exportJsonBtn">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î JSON</button>
          <button class="btn ghost" id="copyBtn">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å JSON</button>
          <button class="btn ghost" id="cleanM3UBtn">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î M3U (Clean)</button>
        </div>

        <div id="status" style="margin-top:10px;color:var(--muted);font-size:13px">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏û‡∏£‡πâ‡∏≠‡∏°</div>
      </div>

      <div class="two">
        <section class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≠‡∏á</strong>
            <div style="font-size:13px;color:var(--muted)"><span id="count">0</span> ‡∏ä‡πà‡∏≠‡∏á</div>
          </div>

          <div class="channels" id="channelsList" aria-live="polite" style="margin-top:10px">
            <!-- channels appended here -->
          </div>
        </section>

        <aside class="card" style="display:flex;flex-direction:column;gap:10px">
          <div>
            <strong>Player Preview</strong>
            <div style="font-size:13px;color:var(--muted)">‡πÄ‡∏•‡πà‡∏ô M3U / m3u8 (HLS) ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ hls.js if required</div>
          </div>
          <div id="videoPlayerWrap" style="position:relative">
            <video id="videoPlayer" controls playsinline></video>
          </div>

          <div class="charts">
            <div id="chartGroups" style="flex:1"></div>
            <div id="chartProto" style="width:180px"></div>
          </div>

          <div class="mermaid-card card" style="padding:10px;">
            <strong>Pipeline</strong>
            <div class="mermaid" id="mermaidDiagram" style="margin-top:8px">
graph LR
  User[‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ] -->|‡πÇ‡∏´‡∏•‡∏î M3U| Parser(Parses M3U)
  Parser -->|‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≠‡∏á| UI[UI Listing]
  UI -->|‡πÄ‡∏•‡πà‡∏ô| Player[HLS/Native Player]
  Player --> Metrics[(ECharts Analytics)]
            </div>
          </div>
        </aside>
      </div>

      <footer>¬© 2025 StreamCraft ‚Ä¢ ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç IPTV & Full‚ÄëStack</footer>
    </main>
  </div>

  <script>
    // Initialize mermaid (ES module loaded separately)
    (async()=> {
      try {
        const mermaid = (await import('https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs')).default;
        mermaid.initialize({ startOnLoad: true, theme: 'dark', flowchart:{curve:'basis'} });
      } catch(e){ console.warn('mermaid load error', e); }
    })();
  </script>

  <script>
    // Utils
    const $ = sel => document.querySelector(sel);
    const status = $('#status');
    const listEl = $('#channelsList');
    const countEl = $('#count');
    let channels = [];
    let useProxy = false;

    function setStatus(t, err=false){ status.textContent = '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ' + t; status.style.color = err ? '#fb7185' : 'var(--muted)'; }

    // parse EXTINF lines into metadata
    function parseEXTINF(line){
      // example: #EXTINF:-1 tvg-id="id" tvg-name="name" tvg-logo="..." group-title="Group",Channel Title
      const info = {title:'',tvg_id:'',tvg_name:'',tvg_logo:'',group:''};
      const attrPart = line.split('#EXTINF:')[1] || '';
      const parts = attrPart.split(',');
      const attrs = parts.slice(0,-1).join(',') || parts[0] || '';
      const title = parts.slice(-1).join(',').trim();
      info.title = title || '';
      // attributes regex
      const re = /([\w-]+)=["']([^"']*)["']/g;
      let m;
      while((m = re.exec(attrs))){
        const k = m[1];
        const v = m[2];
        if(k.toLowerCase().includes('tvg-id')) info.tvg_id = v;
        else if(k.toLowerCase().includes('tvg-name')) info.tvg_name = v;
        else if(k.toLowerCase().includes('tvg-logo')) info.tvg_logo = v;
        else if(k.toLowerCase().includes('group-title')) info.group = v;
        else info[k] = v;
      }
      return info;
    }

    function parseM3U(text){
      const lines = text.split(/\r?\n/);
      const items=[];
      let lastInfo = null;
      for(let raw of lines){
        const line = raw.trim();
        if(!line) continue;
        if(line.startsWith('#EXTINF')){
          lastInfo = parseEXTINF(line);
        } else if(line.startsWith('#')) {
          // ignore other comments
        } else {
          // URL line
          const url = line;
          const meta = lastInfo ? {...lastInfo} : {title:''};
          meta.url = url;
          if(!meta.title) {
            // try to derive from url or tvg-name
            meta.title = meta['tvg-name'] || meta.tvg_id || url.split('/').pop() || url;
          }
          items.push(meta);
          lastInfo = null;
        }
      }
      return items;
    }

    // UI functions
    function renderChannels(arr){
      channels = arr;
      listEl.innerHTML = '';
      arr.forEach((ch, idx) => {
        const div = document.createElement('div');
        div.className = 'ch';
        const logo = ch.tvg_logo || '';
        const emoji = chooseEmojiFromGroup(ch.group || ch.title);
        div.innerHTML = `
          <div class="thumb">${ logo ? `<img src="${escapeHtml(logo)}" alt="" style="max-width:100%;max-height:100%;border-radius:6px">` : emoji }</div>
          <div class="meta">
            <h4 title="${escapeHtml(ch.title)}">${escapeHtml(ch.title)}</h4>
            <p>${escapeHtml(ch.group || 'No group')} ‚Ä¢ <span style="opacity:0.8">ID:${escapeHtml(ch.tvg_id||'-')}</span></p>
            <div style="font-size:12px;color:var(--muted);margin-top:6px">${escapeHtml(shorten(ch.url, 70))}</div>
          </div>
          <div class="play-actions">
            <button class="btn" data-idx="${idx}" onclick="playChannel(${idx})"><span class="mdi mdi-play"></span> ‡πÄ‡∏•‡πà‡∏ô</button>
            <button class="btn ghost" onclick="openStream(${idx})" style="background:transparent;border:1px solid rgba(255,255,255,0.03)"><span class="mdi mdi-open-in-new"></span></button>
          </div>
        `;
        listEl.appendChild(div);
      });
      countEl.textContent = arr.length;
      updateCharts();
    }

    // small helpers
    function escapeHtml(s){ return (s||'').toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
    function shorten(s,n){ return s.length>n ? s.slice(0,n-1)+'‚Ä¶' : s }
    function chooseEmojiFromGroup(g){
      if(!g) return 'üì∫';
      g = g.toLowerCase();
      if(g.includes('news')) return 'üì∞';
      if(g.includes('sport')) return '‚öΩ';
      if(g.includes('movie')||g.includes('film')) return 'üé¨';
      if(g.includes('music')) return 'üéµ';
      if(g.includes('kids')) return 'üß∏';
      if(g.includes('doc')) return 'üìö';
      return 'üì∫';
    }

    // play logic with hls.js fallback
    let hlsInstance = null;
    window.playChannel = function(idx){
      const ch = channels[idx];
      if(!ch) return;
      const video = document.getElementById('videoPlayer');
      const src = ch.url;
      // stop previous
      if(hlsInstance){ hlsInstance.destroy(); hlsInstance = null; }
      if(video.canPlayType('application/vnd.apple.mpegurl') || src.toLowerCase().includes('.m3u8') && /Safari/.test(navigator.userAgent)){
        video.src = src;
        video.play().catch(()=>{});
      } else if(Hls.isSupported() && src.toLowerCase().includes('.m3u8')){
        hlsInstance = new Hls();
        hlsInstance.loadSource(src);
        hlsInstance.attachMedia(video);
        hlsInstance.on(Hls.Events.MANIFEST_PARSED, function() { video.play().catch(()=>{}); });
      } else {
        // non-HLS stream (http/rtmp) just open in new tab
        window.open(src, '_blank');
      }
      setStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô: ' + ch.title);
    };

    window.openStream = function(idx){
      const ch = channels[idx];
      if(!ch) return;
      window.open(ch.url,'_blank');
    };

    // fetch M3U from URL or file
    $('#fetchBtn').addEventListener('click', async () => {
      const url = $('#m3uUrl').value.trim();
      if(!url){ setStatus('‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏™‡πà URL',true); return; }
      setStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î...');
      try {
        const target = useProxy ? proxyUrl(url) : url;
        const res = await fetch(target);
        if(!res.ok) throw new Error('HTTP ' + res.status);
        const txt = await res.text();
        const parsed = parseM3U(txt);
        if(parsed.length===0) setStatus('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå', true);
        else { setStatus('‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ('+parsed.length+' ‡∏ä‡πà‡∏≠‡∏á)'); renderChannels(parsed); }
      } catch(err){
        setStatus('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ: '+err.message, true);
      }
    });

    // proxy utility
    function proxyUrl(url){
      // user-visible example proxies; here we use allorigins as default (public)
      // Note: for heavy/production use, provide your own proxy.
      return 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
    }

    // toggle proxy
    $('#useProxyBtn').addEventListener('click', ()=>{
      useProxy = !useProxy;
      $('#useProxyBtn').textContent = useProxy ? 'Proxy: ON' : '‡πÉ‡∏ä‡πâ CORS proxy';
      $('#useProxyBtn').style.background = useProxy ? 'linear-gradient(90deg,var(--accent2),var(--accent1))' : '';
    });

    // upload file
    $('#uploadBtn').addEventListener('click', ()=> $('#fileInput').click());
    $('#fileInput').addEventListener('change', async (e) => {
      const f = e.target.files[0];
      if(!f) return;
      setStatus('‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå local...');
      const txt = await f.text();
      const parsed = parseM3U(txt);
      if(parsed.length===0) setStatus('‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≠‡∏á', true);
      else { setStatus('‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ('+parsed.length+' ‡∏ä‡πà‡∏≠‡∏á)'); renderChannels(parsed); }
    });

    // export JSON / copy / clean M3U
    $('#exportJsonBtn').addEventListener('click', ()=>{
      if(!channels.length){ setStatus('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î',true); return; }
      const blob = new Blob([JSON.stringify(channels, null, 2)], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'channels.json';
      a.click();
      URL.revokeObjectURL(a.href);
    });

    $('#copyBtn').addEventListener('click', async ()=>{
      if(!channels.length){ setStatus('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å',true); return; }
      try {
        await navigator.clipboard.writeText(JSON.stringify(channels, null, 2));
        setStatus('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å JSON ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß');
      } catch(e){ setStatus('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å: '+e.message, true); }
    });

    $('#cleanM3UBtn').addEventListener('click', ()=>{
      if(!channels.length){ setStatus('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î',true); return; }
      let out = '#EXTM3U\n';
      channels.forEach(ch=>{
        // build simple EXTINF
        const attrs = [];
        if(ch.tvg_id) attrs.push(`tvg-id="${ch.tvg_id}"`);
        if(ch.tvg_name) attrs.push(`tvg-name="${ch.tvg_name}"`);
        if(ch.tvg_logo) attrs.push(`tvg-logo="${ch.tvg_logo}"`);
        if(ch.group) attrs.push(`group-title="${ch.group}"`);
        out += `#EXTINF:-1 ${attrs.join(' ')} ,${ch.title}\n${ch.url}\n`;
      });
      const blob = new Blob([out], {type:'application/x-mpegURL'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'cleaned.m3u';
      a.click();
      URL.revokeObjectURL(a.href);
      setStatus('‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î M3U ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    });

    // basic charts via ECharts
    const chartGroups = echarts.init(document.getElementById('chartGroups'));
    const chartProto = echarts.init(document.getElementById('chartProto'));

    function updateCharts(){
      // groups
      const groups = {};
      const proto = {};
      channels.forEach(c=>{
        const g = c.group || 'Ungrouped';
        groups[g] = (groups[g]||0)+1;
        const p = (c.url||'').split(':')[0] || 'other';
        proto[p] = (proto[p]||0)+1;
      });
      const gdata = Object.keys(groups).map(k=>({name:k,value:groups[k]}));
      const pdata = Object.keys(proto).map(k=>({name:k,value:proto[k]}));

      chartGroups.setOption({
        title:{text:'‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á',left:8,textStyle:{color:'#e6eef6',fontSize:13}},
        tooltip:{},
        series:[{
          type:'pie',radius:['40%','70%'],data:gdata, label:{color:'#cfeafe',formatter:'{b}\n{d}%'}
        }]
      });

      chartProto.setOption({
        title:{text:'protocol',left:'center',textStyle:{color:'#e6eef6',fontSize:12}},
        tooltip:{},
        xAxis:{type:'category',data:pdata.map(d=>d.name),axisLine:{show:false}},
        yAxis:{type:'value',axisLine:{show:false},splitLine:{show:false}},
        series:[{type:'bar',data:pdata.map(d=>d.value),itemStyle:{color:'#2dd4bf'}}]
      });
    }

    // small demo: parse sample if none loaded
    const sample = `#EXTM3U
#EXTINF:-1 tvg-id="101" tvg-name="MovieOne HD" tvg-logo="" group-title="Entertainment",MovieOne HD
http://example.com/stream/movieone.m3u8
#EXTINF:-1 tvg-id="204" tvg-name="NewsLive" tvg-logo="" group-title="News",NewsLive
http://example.com/stream/newslive.m3u8
#EXTINF:-1 tvg-id="305" tvg-name="Sports Arena" tvg-logo="" group-title="Sports",Sports Arena
http://example.com/stream/sports.m3u8
`;
    renderChannels(parseM3U(sample));
    setStatus('‡∏û‡∏£‡πâ‡∏≠‡∏° ‚Äî ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î (‡∏ó‡∏î‡∏™‡∏≠‡∏ö)');
  </script>
</body>
</html>
